<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Magazine Flipbook</title>

  <!-- PageFlip CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/page-flip@2.0.7/dist/css/page-flip.min.css">

  <style>
    html, body { height: 100%; margin: 0; background: #111; }
    #book { width: 100%; max-width: 1100px; height: 700px; margin: 24px auto; }
  </style>
</head>
<body>
  <div id="book"></div>

  <script src="https://cdn.jsdelivr.net/npm/page-flip@2.0.7/dist/js/page-flip.browser.min.js"></script>
  <script>
    // Keep your 2550x3300 aspect ratio
    const book = new St.PageFlip(document.getElementById('book'), {
      width: 772, height: 1000, size: 'stretch',
      showCover: true, maxShadowOpacity: 0.2, mobileScrollSupport: true
    });

    const TOTAL = 17;              // total images you want in the book
    const FOLDER = 'Pages';        // case-sensitive
    const EXTS = ['.jpg', '.JPG', '.jpeg', '.png']; // try these extensions

    // try multiple filename variants for each page number (Page2, Page02, etc.)
    const candidatesFor = (n) => {
      const num = String(n);
      const num2 = String(n).padStart(2, '0'); // zero-padded
      const bases = [`Page${num}`, `Page${num2}`];
      const out = [];
      for (const b of bases) for (const e of EXTS) out.push(`${FOLDER}/${b}${e}`);
      return out;
    };

    const probe = (src) => new Promise((res, rej) => {
      const img = new Image();
      img.onload = () => res(src);
      img.onerror = () => rej(src);
      img.src = src + '?v=' + Date.now(); // cache-bust
    });

    (async () => {
      const pages = [];

      // 1) Cover: Page.jpg / Page.JPG (fail loudly if missing)
      let coverFound = false;
      for (const c of [`${FOLDER}/Page.jpg`, `${FOLDER}/Page.JPG`, `${FOLDER}/Page.jpeg`, `${FOLDER}/Page.png`]) {
        try { await probe(c); pages.push(c); coverFound = true; break; } catch {}
      }
      if (!coverFound) {
        alert(`Cover not found. Expected one of:
${FOLDER}/Page.jpg
${FOLDER}/Page.JPG
${FOLDER}/Page.jpeg
${FOLDER}/Page.png`);
        return;
      }

      // 2) Remaining pages: fill TOTAL-1 pages starting from the smallest existing number
      //    (supports Page1.jpg OR starting at Page2.jpg if Page1 doesn't exist)
      let nextNum = 1;
      // See if Page1.* exists; if not, try Page2.*
      const hasPage1 = await (async () => {
        for (const c of candidatesFor(1)) { try { await probe(c); return c; } catch {} }
        return null;
      })();
      if (!hasPage1) nextNum = 2;

      while (pages.length < TOTAL) {
        let found = null;
        for (const c of candidatesFor(nextNum)) {
          try { await probe(c); found = c; break; } catch {}
        }
        if (!found) {
          alert(`Missing image for Page${nextNum}.
Tried:
${candidatesFor(nextNum).join('\n')}
Rename the file in GitHub, or adjust this list.`);
          return;
        }
        pages.push(found);
        nextNum++;
      }

      // 3) Load
      book.loadFromImages(pages);

      // Optional arrows
      document.addEventListener('keydown', e => {
        if (e.key === 'ArrowRight') book.flipNext();
        if (e.key === 'ArrowLeft') book.flipP
